{% extends 'base.html' %}

{% block title %}Dashboard - EduVanta{% endblock %}

{% block extra_css %}
<style>
  .xp-progress-circle {
    position: relative;
    width: 120px;
    height: 120px;
  }
  .xp-progress-circle svg {
    transform: rotate(-90deg);
  }
  .xp-progress-circle circle {
    stroke-dashoffset: 0;
    transition: stroke-dashoffset 1s ease;
    stroke: #e2e8f0;
    stroke-width: 8px;
  }
  .xp-progress-circle .progress {
    stroke: #FACC15;
    stroke-linecap: round;
  }
  .xp-progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
  }
  .streak-counter {
    position: relative;
    overflow: hidden;
  }
  .streak-flame {
    animation: flicker 1.5s infinite alternate;
    filter: drop-shadow(0 0 5px rgba(239, 68, 68, 0.5));
  }
  @keyframes flicker {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(0.95); }
  }
  .badge-glow {
    animation: glow 2s infinite alternate;
  }
  @keyframes glow {
    from { box-shadow: 0 0 5px -5px #FACC15; }
    to { box-shadow: 0 0 10px 5px #FACC15; }
  }
  .course-card {
    transition: all 0.3s ease;
  }
  .course-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
</style>
{% endblock %}

{% block content %}
<div class="py-6">
    <!-- Welcome Section with Role-Based Content -->
    <div class="bg-gradient-to-r from-indigo-500 to-cyan-500 rounded-xl shadow-lg p-6 mb-6 text-white">
        <div class="flex flex-col md:flex-row items-start md:items-center justify-between">
            <div>
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold">Welcome back, {{ user.first_name|default:user.username }}!</h1>
                    {% if user.role == 'student' %}
                    <span class="ml-2 bg-indigo-600 text-xs px-2 py-1 rounded-full">üéì Student</span>
                    {% elif user.role == 'instructor' %}
                    <span class="ml-2 bg-cyan-600 text-xs px-2 py-1 rounded-full">üßë‚Äçüè´ Instructor</span>
                    {% elif user.role == 'parent' %}
                    <span class="ml-2 bg-purple-600 text-xs px-2 py-1 rounded-full">üë®‚Äçüë©‚Äçüëß Parent</span>
                    {% elif user.role == 'admin' %}
                    <span class="ml-2 bg-red-600 text-xs px-2 py-1 rounded-full">‚öôÔ∏è Admin</span>
                    {% endif %}
                </div>
                {% if user.role == 'student' %}
                <p class="mt-1 text-indigo-100">Continue your learning journey! You're making great progress.</p>
                {% elif user.role == 'instructor' %}
                <p class="mt-1 text-indigo-100">Your students are waiting for your next lesson!</p>
                {% elif user.role == 'parent' %}
                <p class="mt-1 text-indigo-100">Track your child's progress and stay involved in their education.</p>
                {% elif user.role == 'admin' %}
                <p class="mt-1 text-indigo-100">Manage your platform and monitor system performance.</p>
                {% endif %}
            </div>
            <div class="flex items-center mt-4 md:mt-0">
                <div class="streak-counter bg-indigo-600 rounded-lg p-3 flex items-center mr-4">
                    <div class="streak-flame text-red-500 mr-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C10.6868 4.48816 8.5 5.5 8.5 8.5C8.5 10.5 9.5 12 12 12C14.5 12 15.5 10.5 15.5 8.5C15.5 5.5 13.3132 4.48816 12 2ZM12 14C9.5 14 7.5 15.5 7.5 18C7.5 20.5 9.5 22 12 22C14.5 22 16.5 20.5 16.5 18C16.5 15.5 14.5 14 12 14Z"/>
                        </svg>
                    </div>
                    <div>
                        <p class="text-xs font-medium">STREAK</p>
                        <p class="text-xl font-bold">{{ user.streak_days|default:"0" }} days</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm text-indigo-100">Last login: {{ user.last_login|date:"F j, Y, g:i a" }}</p>
                    <p class="text-sm text-indigo-100">Edu ID: <span class="font-mono">{{ user.edu_id|default:"EDU0001" }}</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Grid with XP Progress and Gamification -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
        <!-- XP Progress Circle -->
        <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-yellow-300">
            <div class="flex flex-col items-center justify-center">
                <div class="xp-progress-circle mb-2">
                    <svg width="120" height="120" viewBox="0 0 120 120">
                        <circle cx="60" cy="60" r="54" fill="none" />
                        <circle class="progress" cx="60" cy="60" r="54" fill="none" 
                            stroke-dasharray="339.292" 
                            stroke-dashoffset="{{ 339.292 * (1 - user.xp_percentage|default:0.25) }}" />
                    </svg>
                    <div class="xp-progress-text">
                        <p class="text-3xl font-bold text-yellow-500">{{ user.xp|default:"250" }}</p>
                        <p class="text-xs text-gray-500">XP</p>
                    </div>
                </div>
                <p class="text-sm font-medium text-gray-700">Level {{ user.level|default:"2" }}</p>
                <p class="text-xs text-gray-500 mt-1">{{ user.xp_to_next_level|default:"750" }} XP to Level {{ user.next_level|default:"3" }}</p>
                
                <!-- Latest Badge -->
                {% if user.latest_badge %}
                <div class="mt-3 flex flex-col items-center">
                    <span class="badge-glow inline-flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 text-yellow-500 text-xl mb-1">
                        {{ user.latest_badge.emoji|default:"üèÜ" }}
                    </span>
                    <p class="text-xs font-medium text-gray-700">{{ user.latest_badge.name|default:"Profile Pioneer" }}</p>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Role-specific stats -->
        {% if user.role == 'student' or user.role == 'instructor' %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center">
                <div class="p-3 rounded-full bg-indigo-100 text-indigo-600">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    {% if user.role == 'student' %}
                    <p class="text-sm font-medium text-gray-600">Enrolled Courses</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ enrolled_courses_count|default:"3" }}</p>
                    {% elif user.role == 'instructor' %}
                    <p class="text-sm font-medium text-gray-600">Teaching Courses</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ teaching_courses_count|default:"2" }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}

        {% if user.role == 'student' %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center">
                <div class="p-3 rounded-full bg-green-100 text-green-600">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-600">Completed Courses</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ completed_courses_count|default:"1" }}</p>
                </div>
            </div>
        </div>
        {% elif user.role == 'instructor' %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center">
                <div class="p-3 rounded-full bg-green-100 text-green-600">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-600">Total Students</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ total_students|default:"24" }}</p>
                </div>
            </div>
        </div>
        {% elif user.role == 'parent' %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center">
                <div class="p-3 rounded-full bg-purple-100 text-purple-600">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-600">Children</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ children_count|default:"2" }}</p>
                </div>
            </div>
        </div>
        {% elif user.role == 'admin' %}
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center">
                <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    <p class="text-sm font-medium text-gray-600">Total Users</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ total_users|default:"156" }}</p>
                </div>
            </div>
        </div>
        {% endif %}

        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center">
                <div class="p-3 rounded-full bg-cyan-100 text-cyan-600">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <div class="ml-4">
                    {% if user.role == 'student' %}
                    <p class="text-sm font-medium text-gray-600">Learning Hours</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ total_learning_hours|default:"12" }}</p>
                    {% elif user.role == 'instructor' %}
                    <p class="text-sm font-medium text-gray-600">Teaching Hours</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ total_teaching_hours|default:"24" }}</p>
                    {% elif user.role == 'parent' %}
                    <p class="text-sm font-medium text-gray-600">Children's Progress</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ avg_children_progress|default:"78" }}%</p>
                    {% elif user.role == 'admin' %}
                    <p class="text-sm font-medium text-gray-600">Platform Uptime</p>
                    <p class="text-2xl font-semibold text-gray-900">{{ platform_uptime|default:"99.8" }}%</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Role-Based Dashboard Content -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Recent Activity with XP Rewards -->
        <div class="bg-white rounded-xl shadow-lg p-6 lg:col-span-1">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2>
                <span class="text-xs font-medium text-yellow-500 bg-yellow-100 px-2 py-1 rounded-full">+XP</span>
            </div>
            <div class="space-y-4">
                {% for activity in recent_activities %}
                <div class="flex items-start p-3 rounded-lg transition-all duration-200 hover:bg-indigo-50">
                    <div class="flex-shrink-0">
                        <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-indigo-100 text-indigo-600">
                            {% if activity.type == 'course_progress' %}
                            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            {% elif activity.type == 'assignment' %}
                            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                            {% elif activity.type == 'discussion' %}
                            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                            </svg>
                            {% else %}
                            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            {% endif %}
                        </span>
                    </div>
                    <div class="ml-4 flex-grow">
                        <p class="text-sm font-medium text-gray-900">{{ activity.description|default:"Completed Python Basics lesson" }}</p>
                        <div class="flex justify-between items-center">
                            <p class="text-xs text-gray-500">{{ activity.timestamp|timesince|default:"2 hours" }} ago</p>
                            {% if activity.xp %}
                            <span class="text-xs font-semibold text-yellow-500">+{{ activity.xp|default:"15" }} XP</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="flex items-start p-3 rounded-lg transition-all duration-200 hover:bg-indigo-50">
                    <div class="flex-shrink-0">
                        <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-indigo-100 text-indigo-600">
                            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </span>
                    </div>
                    <div class="ml-4 flex-grow">
                        <p class="text-sm font-medium text-gray-900">Completed Python Basics lesson</p>
                        <div class="flex justify-between items-center">
                            <p class="text-xs text-gray-500">2 hours ago</p>
                            <span class="text-xs font-semibold text-yellow-500">+15 XP</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-start p-3 rounded-lg transition-all duration-200 hover:bg-indigo-50">
                    <div class="flex-shrink-0">
                        <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-green-100 text-green-600">
                            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                        </span>
                    </div>
                    <div class="ml-4 flex-grow">
                        <p class="text-sm font-medium text-gray-900">Submitted Data Science assignment</p>
                        <div class="flex justify-between items-center">
                            <p class="text-xs text-gray-500">Yesterday</p>
                            <span class="text-xs font-semibold text-yellow-500">+25 XP</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Role-specific middle section -->
        {% if user.role == 'student' %}
        <!-- Continue Learning for Students -->
        <div class="bg-white rounded-xl shadow-lg p-6 lg:col-span-2">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Continue Learning</h2>
            <div class="space-y-4">
                {% for course in current_courses %}
                <div class="course-card bg-gradient-to-r from-indigo-50 to-cyan-50 rounded-xl overflow-hidden shadow">
                    <div class="p-4">
                        <div class="flex items-start">
                            <img src="{{ course.thumbnail.url|default:'#' }}" alt="{{ course.title }}" class="h-16 w-16 rounded-lg object-cover">
                            <div class="ml-4 flex-grow">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-md font-semibold text-gray-900">{{ course.title|default:'Introduction to Python' }}</h3>
                                        <p class="text-sm text-gray-600">{{ course.instructor|default:'Dr. Jane Smith' }}</p>
                                    </div>
                                    <span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full">{{ course.category|default:'Programming' }}</span>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-xs font-medium text-gray-700">Progress: {{ course.progress|default:'45' }}%</span>
                                        <span class="text-xs text-gray-500">{{ course.completed_lessons|default:'9' }}/{{ course.total_lessons|default:'20' }} lessons</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-indigo-500 to-cyan-500 h-2 rounded-full" style="width: {{ course.progress|default:'45' }}%"></div>
                                    </div>
                                </div>
                                <div class="mt-3 flex justify-between items-center">
                                    <a href="{% url 'course_detail' course.id|default:1 %}" class="inline-flex items-center px-3 py-1 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 transition-colors">
                                        Continue
                                        <svg class="ml-1 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </a>
                                    <p class="text-xs text-gray-500">Next: {{ course.next_lesson|default:'Functions & Methods' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="course-card bg-gradient-to-r from-indigo-50 to-cyan-50 rounded-xl overflow-hidden shadow">
                    <div class="p-4">
                        <div class="flex items-start">
                            <div class="h-16 w-16 rounded-lg bg-indigo-200 flex items-center justify-center text-indigo-600">
                                <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                            <div class="ml-4 flex-grow">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h3 class="text-md font-semibold text-gray-900">Introduction to Python</h3>
                                        <p class="text-sm text-gray-600">Dr. Jane Smith</p>
                                    </div>
                                    <span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full">Programming</span>
                                </div>
                                <div class="mt-2">
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="text-xs font-medium text-gray-700">Progress: 45%</span>
                                        <span class="text-xs text-gray-500">9/20 lessons</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-gradient-to-r from-indigo-500 to-cyan-500 h-2 rounded-full" style="width: 45%"></div>
                                    </div>
                                </div>
                                <div class="mt-3 flex justify-between items-center">
                                    <a href="#" class="inline-flex items-center px-3 py-1 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 transition-colors">
                                        Continue
                                        <svg class="ml-1 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                        </svg>
                                    </a>
                                    <p class="text-xs text-gray-500">Next: Functions & Methods</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        {% elif user.role == 'instructor' %}
        <!-- Quick Actions for Instructors -->
        <div class="bg-white rounded-xl shadow-lg p-6 lg:col-span-2">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Instructor Dashboard</h2>
            
            <!-- Quick Actions -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-indigo-50 rounded-xl p-4 flex items-center">
                    <div class="p-3 rounded-full bg-indigo-100 text-indigo-600 mr-4">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-900">Create New Course</h3>
                        <p class="text-sm text-gray-600">Start building your next course</p>
                    </div>
                </div>
                
                <div class="bg-cyan-50 rounded-xl p-4 flex items-center">
                    <div class="p-3 rounded-full bg-cyan-100 text-cyan-600 mr-4">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"></path>
                        </svg>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-900">Post Announcement</h3>
                        <p class="text-sm text-gray-600">Share updates with your students</p>
                    </div>
                </div>
            </div>
            
            <!-- Analytics Overview -->
            <div class="bg-gray-50 rounded-xl p-4 mb-6">
                <h3 class="font-medium text-gray-900 mb-2">Course Completion Rates</h3>
                <div class="space-y-3">
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm">Introduction to Python</span>
                            <span class="text-sm font-medium">78%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 78%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-sm">Data Science Fundamentals</span>
                            <span class="text-sm font-medium">62%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-green-500 h-2 rounded-full" style="width: 62%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Recent Discussion Activity -->
            <div>
                <h3 class="font-medium text-gray-900 mb-2">Recent Discussion Activity</h3>
                <div class="space-y-3">
                    <div class="border border-gray-200 rounded-lg p-3">
                        <div class="flex justify-between items-start">
                            <p class="text-sm font-medium">Question about API integration</p>
                            <span class="text-xs text-gray-500">2h ago</span>
                        </div>
                        <p class="text-xs text-gray-600 mt-1">From: Alex Johnson in Web Development</p>
                        <div class="flex justify-end mt-2">
                            <button class="text-xs text-indigo-600 hover:text-indigo-800">View & Reply</button>
                        </div>
                    </div>
                    <div class="border border-gray-200 rounded-lg p-3">
                        <div class="flex justify-between items-start">
                            <p class="text-sm font-medium">Feedback on final project</p>
                            <span class="text-xs text-gray-500">1d ago</span>
                        </div>
                        <p class="text-xs text-gray-600 mt-1">From: Maria Garcia in Data Science</p>
                        <div class="flex justify-end mt-2">
                            <button class="text-xs text-indigo-600 hover:text-indigo-800">View & Reply</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% elif user.role == 'parent' %}
        <!-- Children's Progress for Parents -->
        <div class="bg-white rounded-xl shadow-lg p-6 lg:col-span-2">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Children's Progress</h2>
            
            <div class="space-y-6">
                <!-- Child 1 -->
                <div class="bg-purple-50 rounded-xl p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="h-10 w-10 rounded-full bg-purple-200 flex items-center justify-center text-purple-600 mr-3">
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-medium text-gray-900">Emma Johnson</h3>
                                <p class="text-xs text-gray-600">Grade 10 ‚Ä¢ EDUS0023</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-purple-600">Level 3</p>
                            <p class="text-xs text-gray-600">425 XP</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm">Overall Progress</span>
                                <span class="text-sm font-medium">82%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-purple-500 h-2 rounded-full" style="width: 82%"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-white rounded-lg p-3 shadow-sm">
                                <p class="text-xs text-gray-600">Attendance</p>
                                <p class="text-lg font-semibold text-gray-900">98%</p>
                            </div>
                            <div class="bg-white rounded-lg p-3 shadow-sm">
                                <p class="text-xs text-gray-600">Avg. Grade</p>
                                <p class="text-lg font-semibold text-gray-900">A-</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <p class="text-sm font-medium">Recent Achievement</p>
                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">üèÜ Math Wizard</span>
                        </div>
                    </div>
                </div>
                
                <!-- Child 2 -->
                <div class="bg-blue-50 rounded-xl p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="h-10 w-10 rounded-full bg-blue-200 flex items-center justify-center text-blue-600 mr-3">
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-medium text-gray-900">Noah Johnson</h3>
                                <p class="text-xs text-gray-600">Grade 8 ‚Ä¢ EDUS0024</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-blue-600">Level 2</p>
                            <p class="text-xs text-gray-600">275 XP</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm">Overall Progress</span>
                                <span class="text-sm font-medium">74%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: 74%"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-white rounded-lg p-3 shadow-sm">
                                <p class="text-xs text-gray-600">Attendance</p>
                                <p class="text-lg font-semibold text-gray-900">95%</p>
                            </div>
                            <div class="bg-white rounded-lg p-3 shadow-sm">
                                <p class="text-xs text-gray-600">Avg. Grade</p>
                                <p class="text-lg font-semibold text-gray-900">B+</p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <p class="text-sm font-medium">Recent Achievement</p>
                            <span class="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full">üî¨ Science Explorer</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% elif user.role == 'admin' %}
        <!-- Admin Dashboard -->
        <div class="bg-white rounded-xl shadow-lg p-6 lg:col-span-2">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Platform Overview</h2>
            
            <!-- Quick Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-gray-50 rounded-lg p-3">
                    <p class="text-xs text-gray-600">Active Users</p>
                    <p class="text-xl font-semibold text-gray-900">124</p>
                    <p class="text-xs text-green-600">‚Üë 12% this week</p>
                </div>
                <div class="bg-gray-50 rounded-lg p-3">
                    <p class="text-xs text-gray-600">New Registrations</p>
                    <p class="text-xl font-semibold text-gray-900">28</p>
                    <p class="text-xs text-green-600">‚Üë 8% this week</p>
                </div>
                <div class="bg-gray-50 rounded-lg p-3">
                    <p class="text-xs text-gray-600">Active Courses</p>
                    <p class="text-xl font-semibold text-gray-900">42</p>
                    <p class="text-xs text-green-600">‚Üë 3 new this week</p>
                </div>
                <div class="bg-gray-50 rounded-lg p-3">
                    <p class="text-xs text-gray-600">System Health</p>
                    <p class="text-xl font-semibold text-green-600">Good</p>
                    <p class="text-xs text-gray-600">All systems operational</p>
                </div>
            </div>
            
            <!-- Admin Actions -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-indigo-50 rounded-xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="p-3 rounded-full bg-indigo-100 text-indigo-600 mb-2">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"></path>
                        </svg>
                    </div>
                    <h3 class="font-medium text-gray-900">System Announcement</h3>
                    <p class="text-xs text-gray-600 mb-2">Notify all users</p>
                    <button class="text-xs bg-indigo-600 text-white px-3 py-1 rounded-md hover:bg-indigo-700 transition-colors">Create</button>
                </div>
                <div class="bg-cyan-50 rounded-xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="p-3 rounded-full bg-cyan-100 text-cyan-600 mb-2">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                    </div>
                    <h3 class="font-medium text-gray-900">User Management</h3>
                    <p class="text-xs text-gray-600 mb-2">Add or modify users</p>
                    <button class="text-xs bg-cyan-600 text-white px-3 py-1 rounded-md hover:bg-cyan-700 transition-colors">Manage</button>
                </div>
                <div class="bg-purple-50 rounded-xl p-4 flex flex-col items-center justify-center text-center">
                    <div class="p-3 rounded-full bg-purple-100 text-purple-600 mb-2">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <h3 class="font-medium text-gray-900">Analytics</h3>
                    <p class="text-xs text-gray-600 mb-2">View detailed reports</p>
                    <button class="text-xs bg-purple-600 text-white px-3 py-1 rounded-md hover:bg-purple-700 transition-colors">View</button>
                </div>
            </div>
            
            <!-- Pending Approvals -->
            <div>
                <h3 class="font-medium text-gray-900 mb-2">Pending Approvals</h3>
                <div class="space-y-2">
                    <div class="border border-gray-200 rounded-lg p-3 flex justify-between items-center">
                        <div>
                            <p class="text-sm font-medium">New Course: Advanced Machine Learning</p>
                            <p class="text-xs text-gray-600">Submitted by: Dr. Robert Chen</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="text-xs bg-green-600 text-white px-2 py-1 rounded hover:bg-green-700 transition-colors">Approve</button>
                            <button class="text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700 transition-colors">Reject</button>
                        </div>
                    </div>
                    <div class="border border-gray-200 rounded-lg p-3 flex justify-between items-center">
                        <div>
                            <p class="text-sm font-medium">Instructor Application: Sarah Williams</p>
                            <p class="text-xs text-gray-600">Department: Computer Science</p>
                        </div>
                        <div class="flex space-x-2">
                            <button class="text-xs bg-green-600 text-white px-2 py-1 rounded hover:bg-green-700 transition-colors">Approve</button>
                            <button class="text-xs bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700 transition-colors">Reject</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Leaderboard Widget -->
        <div class="bg-white rounded-xl shadow-lg p-6 lg:col-span-1">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-900">Leaderboard</h2>
                <span class="text-xs font-medium text-indigo-600 bg-indigo-100 px-2 py-1 rounded-full">{{ user.department|default:"Computer Science" }}</span>
            </div>
            <div class="space-y-3">
                {% for leader in leaderboard %}
                <div class="flex items-center p-2 {% if leader.rank == 1 %}bg-yellow-50{% elif leader.rank == 2 %}bg-gray-50{% elif leader.rank == 3 %}bg-amber-50{% else %}{% endif %} rounded-lg">
                    <span class="w-6 h-6 flex items-center justify-center rounded-full {% if leader.rank == 1 %}bg-yellow-200 text-yellow-800{% elif leader.rank == 2 %}bg-gray-200 text-gray-800{% elif leader.rank == 3 %}bg-amber-200 text-amber-800{% else %}bg-indigo-100 text-indigo-800{% endif %} text-sm font-bold mr-3">
                        {{ leader.rank }}
                    </span>
                    <div class="flex-grow">
                        <p class="text-sm font-medium text-gray-900">{{ leader.name }}</p>
                        <p class="text-xs text-gray-500">Level {{ leader.level }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-semibold text-yellow-500">{{ leader.xp }} XP</p>
                        {% if leader.is_current_user %}
                        <span class="text-xs text-indigo-600">You</span>
                        {% endif %}
                    </div>
                </div>
                {% empty %}
                <div class="flex items-center p-2 bg-yellow-50 rounded-lg">
                    <span class="w-6 h-6 flex items-center justify-center rounded-full bg-yellow-200 text-yellow-800 text-sm font-bold mr-3">1</span>
                    <div class="flex-grow">
                        <p class="text-sm font-medium text-gray-900">Alex Johnson</p>
                        <p class="text-xs text-gray-500">Level 5</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-semibold text-yellow-500">1250 XP</p>
                    </div>
                </div>
                <div class="flex items-center p-2 bg-gray-50 rounded-lg">
                    <span class="w-6 h-6 flex items-center justify-center rounded-full bg-gray-200 text-gray-800 text-sm font-bold mr-3">2</span>
                    <div class="flex-grow">
                        <p class="text-sm font-medium text-gray-900">Maria Garcia</p>
                        <p class="text-xs text-gray-500">Level 4</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-semibold text-yellow-500">980 XP</p>
                    </div>
                </div>
                <div class="flex items-center p-2 bg-amber-50 rounded-lg">
                    <span class="w-6 h-6 flex items-center justify-center rounded-full bg-amber-200 text-amber-800 text-sm font-bold mr-3">3</span>
                    <div class="flex-grow">
                        <p class="text-sm font-medium text-gray-900">James Smith</p>
                        <p class="text-xs text-gray-500">Level 4</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-semibold text-yellow-500">875 XP</p>
                    </div>
                </div>
                <div class="flex items-center p-2 rounded-lg">
                    <span class="w-6 h-6 flex items-center justify-center rounded-full bg-indigo-100 text-indigo-800 text-sm font-bold mr-3">4</span>
                    <div class="flex-grow">
                        <p class="text-sm font-medium text-gray-900">{{ user.first_name|default:user.username }}</p>
                        <p class="text-xs text-gray-500">Level {{ user.level|default:"2" }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-semibold text-yellow-500">{{ user.xp|default:"250" }} XP</p>
                        <span class="text-xs text-indigo-600">You</span>
                    </div>
                </div>
                {% endfor %}
                <div class="mt-4 text-center">
                    <a href="#" class="text-sm text-indigo-600 hover:text-indigo-800">View Full Leaderboard</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}